const _0x591043=_0x20ce;(function(_0x167daf,_0x3ecc6b){const _0xae0a5f=_0x20ce,_0x329c92=_0x167daf();while(!![]){try{const _0x530958=parseInt(_0xae0a5f(0x124))/0x1+parseInt(_0xae0a5f(0x134))/0x2+parseInt(_0xae0a5f(0xd6))/0x3*(-parseInt(_0xae0a5f(0x15d))/0x4)+parseInt(_0xae0a5f(0xb2))/0x5+parseInt(_0xae0a5f(0x115))/0x6*(-parseInt(_0xae0a5f(0x10c))/0x7)+parseInt(_0xae0a5f(0xa8))/0x8*(-parseInt(_0xae0a5f(0xdc))/0x9)+parseInt(_0xae0a5f(0x149))/0xa;if(_0x530958===_0x3ecc6b)break;else _0x329c92['push'](_0x329c92['shift']());}catch(_0x54469d){_0x329c92['push'](_0x329c92['shift']());}}}(_0x1da8,0xc1716));import{initializeApp}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js';import{getAuth,signInAnonymously,onAuthStateChanged,signInWithCustomToken}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js';import{getFirestore,setDoc,getDoc,doc,collection,addDoc,getDocs,onSnapshot,deleteDoc,updateDoc,setLogLevel}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js';const GEMINI_API_MODEL=_0x591043(0x125),GEMINI_API_KEY=_0x591043(0x11f),GEMINI_API_URL=_0x591043(0xef)+GEMINI_API_MODEL+_0x591043(0x150)+GEMINI_API_KEY,firebaseConfig={'apiKey':_0x591043(0xc7),'authDomain':_0x591043(0x155),'projectId':'programpp-91f08','storageBucket':_0x591043(0xad),'messagingSenderId':_0x591043(0x135),'appId':_0x591043(0x98),'measurementId':_0x591043(0x11c)},appId=typeof __app_id!==_0x591043(0xcf)?__app_id:_0x591043(0x132);let db,auth,userId,listCollectionPath,listsCollection,wordListCollectionPath,wordListsCollection,settingsDoc,appMode=_0x591043(0x168),masterNames=[],availableNames=[],pickedNames=[],isSpinning=![],revealTimer=null,currentWinner=null,revealQueue=[],letterSpans=[],revealIndex=0x0,countdownInterval=null;const settings={'revealDelayMs':0x12c,'enableSFX':!![],'ttsFinal':!![],'noRepeat':!![],'revealMode':_0x591043(0xbc),'enableMathChallenge':![],'mathChallengeTimer':0x5};let audioCtx=null;const tickFrequencies=[0x370,0x3db,0x416,0x496,0x526];let tickIndex=0x0;const segmenter=new Intl['Segmenter']('th',{'granularity':'grapheme'}),getGraphemes=_0x1f61c1=>Array['from'](segmenter['segment'](_0x1f61c1))['map'](_0x17f7b0=>_0x17f7b0[_0x591043(0xe8)]),revealArea=document[_0x591043(0x153)]('reveal-area'),revealText=document[_0x591043(0x153)]('reveal-text'),startButton=document[_0x591043(0x153)](_0x591043(0x13b)),nextButton=document[_0x591043(0x153)](_0x591043(0xc1)),revealAnswerButton=document[_0x591043(0x153)](_0x591043(0x16c)),resetButton=document[_0x591043(0x153)](_0x591043(0xbe)),settingsButton=document[_0x591043(0x153)](_0x591043(0x128)),settingsModal=document[_0x591043(0x153)](_0x591043(0x139)),closeSettingsButton=document['getElementById']('close-settings-button'),historyArea=document[_0x591043(0x153)](_0x591043(0x9a)),namesRemainingEl=document['getElementById'](_0x591043(0x10e)),namesTotalEl=document[_0x591043(0x153)](_0x591043(0x165)),historyTitle=document['getElementById']('history-title'),mathChallengeText=document[_0x591043(0x153)](_0x591043(0xc4)),countdownTimerEl=document[_0x591043(0x153)](_0x591043(0x15f)),modeToggleNames=document[_0x591043(0x153)](_0x591043(0x16d)),modeToggleWords=document['getElementById'](_0x591043(0x102)),nameListManager=document[_0x591043(0x153)](_0x591043(0xb4)),wordListManager=document['getElementById']('word-list-manager'),nameListTextArea=document[_0x591043(0x153)]('name-list'),updateListButton=document['getElementById'](_0x591043(0x97)),listSelect=document[_0x591043(0x153)](_0x591043(0xca)),loadSelectedListButton=document[_0x591043(0x153)](_0x591043(0x8f)),deleteSelectedListButton=document[_0x591043(0x153)](_0x591043(0xfe)),newListNameInput=document[_0x591043(0x153)](_0x591043(0x16a)),saveAsNewListButton=document[_0x591043(0x153)](_0x591043(0x116)),updateSelectedListButton=document[_0x591043(0x153)]('update-selected-list-button'),aiWordCount=document[_0x591043(0x153)]('ai-word-count'),aiStartLength=document['getElementById'](_0x591043(0xf5)),aiGenerateButton=document[_0x591043(0x153)](_0x591043(0x119)),aiLoadingSpinner=document[_0x591043(0x153)](_0x591043(0x148)),aiErrorMessage=document[_0x591043(0x153)]('ai-error-message'),wordListTextArea=document['getElementById'](_0x591043(0x16f)),updateWordListButton=document[_0x591043(0x153)](_0x591043(0xb8)),wordListSelect=document['getElementById'](_0x591043(0x158)),loadSelectedWordListButton=document['getElementById'](_0x591043(0x133)),deleteSelectedWordListButton=document['getElementById']('delete-selected-word-list-button'),newWordListNameInput=document[_0x591043(0x153)](_0x591043(0xfa)),saveAsNewWordListButton=document['getElementById'](_0x591043(0x94)),updateSelectedWordListButton=document[_0x591043(0x153)](_0x591043(0x89));function shuffleArray(_0xf01aa6){const _0x14c95b=_0x591043;for(let _0x2cc3d4=_0xf01aa6[_0x14c95b(0x157)]-0x1;_0x2cc3d4>0x0;_0x2cc3d4--){const _0xc5249a=Math[_0x14c95b(0x160)](Math[_0x14c95b(0xb5)]()*(_0x2cc3d4+0x1));[_0xf01aa6[_0x2cc3d4],_0xf01aa6[_0xc5249a]]=[_0xf01aa6[_0xc5249a],_0xf01aa6[_0x2cc3d4]];}return _0xf01aa6;}function startRevealProcess(){const _0x2bd474=_0x591043;clearTimeout(revealTimer);if(isSpinning)return;if(availableNames[_0x2bd474(0x157)]===0x0){revealText[_0x2bd474(0x8c)]=appMode===_0x2bd474(0x168)?'รายชื่อหมดแล้ว!':_0x2bd474(0x107),revealText[_0x2bd474(0xb9)][_0x2bd474(0x131)](_0x2bd474(0xae)),showButton(resetButton),hideButton(startButton),hideButton(nextButton),hideButton(revealAnswerButton);return;}isSpinning=!![],hideButton(startButton),hideButton(nextButton),hideButton(resetButton),hideButton(revealAnswerButton),revealArea[_0x2bd474(0xb9)][_0x2bd474(0x96)]('flash-winner'),revealText[_0x2bd474(0xb9)][_0x2bd474(0x96)](_0x2bd474(0xae)),mathChallengeText[_0x2bd474(0xb9)][_0x2bd474(0x131)]('hidden'),mathChallengeText[_0x2bd474(0x8c)]='',clearInterval(countdownInterval),countdownTimerEl[_0x2bd474(0xb9)][_0x2bd474(0x131)]('hidden');appMode===_0x2bd474(0x168)?currentWinner=availableNames[Math[_0x2bd474(0x160)](Math[_0x2bd474(0xb5)]()*availableNames[_0x2bd474(0x157)])]:currentWinner=availableNames[0x0];if(settings[_0x2bd474(0xf2)]===_0x2bd474(0x106))startDigitalSpin();else{const _0x284160=getGraphemes(currentWinner),_0x53f35c=shuffleArray([..._0x284160]);revealQueue=_0x53f35c,revealIndex=0x0,letterSpans=[],revealText[_0x2bd474(0x10d)]='';for(let _0x5990a3=0x0;_0x5990a3<_0x284160[_0x2bd474(0x157)];_0x5990a3++){const _0x139ff1=document['createElement'](_0x2bd474(0x130));_0x139ff1[_0x2bd474(0x8c)]='_',_0x139ff1[_0x2bd474(0x113)]=_0x2bd474(0x12f),revealText['appendChild'](_0x139ff1),letterSpans['push'](_0x139ff1);}revealTimer=setTimeout(revealNextShuffledGrapheme,settings[_0x2bd474(0x146)]);}}function startDigitalSpin(){const _0x2c8871=_0x591043,_0x12ce2b=0xbb8,_0x3f82e0=Math[_0x2c8871(0x12a)](settings[_0x2c8871(0x146)],0x64),_0x506fac=Date[_0x2c8871(0x163)]()+_0x12ce2b;revealText[_0x2c8871(0x10d)]='',revealText[_0x2c8871(0x113)]=_0x2c8871(0xe2),spinLoop(_0x506fac,_0x3f82e0);}function spinLoop(_0x40406c,_0x568d11){const _0x45133f=_0x591043,_0x398259=Date[_0x45133f(0x163)]();if(_0x398259>=_0x40406c)revealText[_0x45133f(0x8c)]=currentWinner,announceWinner(currentWinner);else{playTickSFX();const _0x43ef96=availableNames[Math[_0x45133f(0x160)](Math[_0x45133f(0xb5)]()*availableNames[_0x45133f(0x157)])];revealText[_0x45133f(0x8c)]=_0x43ef96;const _0x3bd4bc=_0x40406c-_0x398259,_0x41a21b=0xbb8,_0x34075c=0x1-_0x3bd4bc/_0x41a21b,_0x4e4895=0x32+_0x34075c*_0x34075c*_0x34075c*(_0x568d11-0x32);revealTimer=setTimeout(()=>spinLoop(_0x40406c,_0x568d11),_0x4e4895);}}function revealNextShuffledGrapheme(){const _0x22ae26=_0x591043;if(revealQueue[_0x22ae26(0x157)]===0x0){settings[_0x22ae26(0xf2)]===_0x22ae26(0xbc)?revealTimer=setTimeout(startScrambleEffect,settings['revealDelayMs']*0x3):showButton(revealAnswerButton);return;}playTickSFX();const _0x3293f8=revealQueue[_0x22ae26(0x108)](),_0x5821ad=letterSpans[revealIndex];_0x5821ad&&(_0x5821ad['textContent']=_0x3293f8,_0x5821ad[_0x22ae26(0x113)]='letter-reveal\x20transition-all\x20duration-100\x20ease-in-out\x20inline-block\x20mx-1\x20text-white',revealIndex++),revealTimer=setTimeout(revealNextShuffledGrapheme,settings[_0x22ae26(0x146)]);}function startScrambleEffect(){const _0x1da702=_0x591043,_0x2104ad=getGraphemes(currentWinner),_0x4eaa36=0x5dc,_0x4d46b5=0x32,_0x42dcd3=Date[_0x1da702(0x163)]()+_0x4eaa36;scrambleLoop(_0x42dcd3,_0x2104ad);}function scrambleLoop(_0x44568c,_0x4321a9){const _0x2e4ad1=_0x591043,_0x1244b4=Date[_0x2e4ad1(0x163)]();if(_0x1244b4>=_0x44568c){for(let _0x36913d=0x0;_0x36913d<letterSpans[_0x2e4ad1(0x157)];_0x36913d++){letterSpans[_0x36913d][_0x2e4ad1(0x8c)]=_0x4321a9[_0x36913d],letterSpans[_0x36913d][_0x2e4ad1(0x113)]='letter-reveal\x20transition-all\x20duration-100\x20ease-in-out\x20inline-block\x20mx-1\x20text-white';}announceWinner(currentWinner);}else{playTickSFX();for(let _0x414eee of letterSpans){const _0xe02551=_0x4321a9[Math[_0x2e4ad1(0x160)](Math[_0x2e4ad1(0xb5)]()*_0x4321a9[_0x2e4ad1(0x157)])];_0x414eee[_0x2e4ad1(0x8c)]=_0xe02551;}revealTimer=setTimeout(()=>scrambleLoop(_0x44568c,_0x4321a9),0x32);}}function announceWinner(_0x3630c0){const _0x4d8b89=_0x591043;clearTimeout(revealTimer),isSpinning=![],revealArea[_0x4d8b89(0xb9)][_0x4d8b89(0x131)]('flash-winner'),playWinnerSFX();if(appMode===_0x4d8b89(0x168)&&settings['enableMathChallenge']){const _0x2b213b=generateMathProblem();mathChallengeText['textContent']=_0x4d8b89(0x92)+_0x2b213b[_0x4d8b89(0x112)]+')',mathChallengeText['classList'][_0x4d8b89(0x96)]('hidden'),clearInterval(countdownInterval);if(settings[_0x4d8b89(0xf7)]>0x0){let _0x3519e4=settings[_0x4d8b89(0xf7)];countdownTimerEl[_0x4d8b89(0x8c)]=_0x3519e4,countdownTimerEl['classList'][_0x4d8b89(0x96)](_0x4d8b89(0xf4),_0x4d8b89(0x15c)),countdownTimerEl[_0x4d8b89(0xb9)][_0x4d8b89(0x131)]('text-red-500'),countdownInterval=setInterval(()=>{const _0x51ded5=_0x4d8b89;_0x3519e4--,_0x3519e4>0x0?countdownTimerEl[_0x51ded5(0x8c)]=_0x3519e4:(clearInterval(countdownInterval),countdownTimerEl['textContent']=_0x51ded5(0xd9)+_0x2b213b[_0x51ded5(0xe4)]+')',countdownTimerEl['classList'][_0x51ded5(0x96)](_0x51ded5(0x12c)),countdownTimerEl[_0x51ded5(0xb9)][_0x51ded5(0x131)](_0x51ded5(0x15c)),playTimeoutSFX());},0x3e8);}}settings[_0x4d8b89(0x100)]&&speakBrowserFallback(_0x3630c0),settings[_0x4d8b89(0xc2)]&&(availableNames=availableNames[_0x4d8b89(0x90)](_0x1de2f5=>_0x1de2f5!==_0x3630c0),!pickedNames[_0x4d8b89(0x8d)](_0x3630c0)&&pickedNames['push'](_0x3630c0)),availableNames[_0x4d8b89(0x157)]>0x0?showButton(nextButton):showButton(resetButton),updateHistoryUI();}function showButton(_0x2e1963){const _0x57a4ab=_0x591043;if(_0x2e1963)_0x2e1963[_0x57a4ab(0xb9)][_0x57a4ab(0x96)]('hidden');}function hideButton(_0x39a9b9){const _0x3351e7=_0x591043;if(_0x39a9b9)_0x39a9b9[_0x3351e7(0xb9)][_0x3351e7(0x131)]('hidden');}function updateHistoryUI(){const _0x418f30=_0x591043;historyArea[_0x418f30(0x10d)]='',pickedNames['length']===0x0?historyArea[_0x418f30(0x10d)]=_0x418f30(0xe7):(pickedNames['forEach']((_0x5ba3d1,_0x418e95)=>{const _0x348bbe=_0x418f30,_0x4e97f2=document[_0x348bbe(0x88)]('p');_0x4e97f2[_0x348bbe(0x8c)]=_0x418e95+0x1+'.\x20'+_0x5ba3d1,_0x4e97f2[_0x348bbe(0x113)]=_0x348bbe(0xde),historyArea['appendChild'](_0x4e97f2);}),historyArea[_0x418f30(0x10b)]=historyArea[_0x418f30(0xa1)]),namesRemainingEl[_0x418f30(0x8c)]=availableNames[_0x418f30(0x157)],namesTotalEl[_0x418f30(0x8c)]=masterNames[_0x418f30(0x157)];}function resetUI(){const _0x206c06=_0x591043;revealText[_0x206c06(0x10d)]=_0x206c06(0xb3),revealText[_0x206c06(0xb9)][_0x206c06(0x96)]('text-red-400'),revealArea[_0x206c06(0xb9)]['remove'](_0x206c06(0xbd)),mathChallengeText[_0x206c06(0xb9)][_0x206c06(0x131)](_0x206c06(0xf4)),mathChallengeText[_0x206c06(0x8c)]='',clearInterval(countdownInterval),countdownTimerEl[_0x206c06(0xb9)]['add'](_0x206c06(0xf4)),showButton(startButton),hideButton(nextButton),hideButton(resetButton),hideButton(revealAnswerButton);}function updateMasterNamesFromTextArea(){const _0x3444b5=_0x591043,_0x2c825=nameListTextArea[_0x3444b5(0x14b)];masterNames=_0x2c825[_0x3444b5(0x11d)]('\x0a')['map'](_0x4bbc68=>_0x4bbc68[_0x3444b5(0x16b)]())[_0x3444b5(0x90)](_0x2850e3=>_0x2850e3[_0x3444b5(0x157)]>0x0),console[_0x3444b5(0x127)](_0x3444b5(0xb1),masterNames),resetSession();}function updateMasterWordsFromTextArea(){const _0x3d3313=_0x591043,_0x1c5a3e=wordListTextArea[_0x3d3313(0x14b)];masterNames=_0x1c5a3e[_0x3d3313(0x11d)]('\x0a')[_0x3d3313(0xbb)](_0x24851a=>_0x24851a[_0x3d3313(0x16b)]())[_0x3d3313(0x90)](_0x59de93=>_0x59de93[_0x3d3313(0x157)]>0x0),console[_0x3d3313(0x127)](_0x3d3313(0x110),masterNames),resetSession();}function resetSession(){const _0x395277=_0x591043;console[_0x395277(0x127)](_0x395277(0xc3)),availableNames=[...masterNames],pickedNames=[],isSpinning=![],clearTimeout(revealTimer),currentWinner=null,revealQueue=[],updateHistoryUI(),resetUI();}function initAudio(){const _0x3c5ede=_0x591043;if(audioCtx)return;try{audioCtx=new(window['AudioContext']||window[(_0x3c5ede(0x118))])();}catch(_0x286e8f){console[_0x3c5ede(0xce)](_0x3c5ede(0xff));}}function playTickSFX(){const _0x19960d=_0x591043;if(!settings[_0x19960d(0xb6)]||!audioCtx)return;const _0x709a6a=audioCtx[_0x19960d(0x14d)](),_0x4a5efc=audioCtx[_0x19960d(0x147)]();_0x709a6a[_0x19960d(0xa6)](_0x4a5efc),_0x4a5efc[_0x19960d(0xa6)](audioCtx[_0x19960d(0xf6)]),_0x709a6a[_0x19960d(0xa0)]=_0x19960d(0x15e),_0x709a6a['frequency'][_0x19960d(0xea)](tickFrequencies[tickIndex%tickFrequencies[_0x19960d(0x157)]],audioCtx['currentTime']),_0x4a5efc['gain'][_0x19960d(0xea)](0.3,audioCtx[_0x19960d(0xaa)]),_0x709a6a[_0x19960d(0xe0)](audioCtx[_0x19960d(0xaa)]),_0x709a6a[_0x19960d(0xba)](audioCtx[_0x19960d(0xaa)]+0.05),tickIndex++;}function playWinnerSFX(){const _0xa95993=_0x591043;if(!settings['enableSFX']||!audioCtx)return;const _0x12a9ba=audioCtx[_0xa95993(0xaa)],_0x14b86b=audioCtx[_0xa95993(0x147)]();_0x14b86b[_0xa95993(0xa6)](audioCtx[_0xa95993(0xf6)]),_0x14b86b[_0xa95993(0x121)][_0xa95993(0xea)](0.5,_0x12a9ba);const _0x2abfe1=audioCtx['createOscillator']();_0x2abfe1[_0xa95993(0xa0)]=_0xa95993(0xc9),_0x2abfe1[_0xa95993(0x12b)]['setValueAtTime'](523.25,_0x12a9ba),_0x2abfe1[_0xa95993(0xa6)](_0x14b86b),_0x2abfe1[_0xa95993(0xe0)](_0x12a9ba),_0x2abfe1[_0xa95993(0xba)](_0x12a9ba+0.3);const _0x4c1733=audioCtx[_0xa95993(0x14d)]();_0x4c1733['type']=_0xa95993(0xc9),_0x4c1733['frequency'][_0xa95993(0xea)](659.25,_0x12a9ba+0.1),_0x4c1733[_0xa95993(0xa6)](_0x14b86b),_0x4c1733[_0xa95993(0xe0)](_0x12a9ba+0.1),_0x4c1733['stop'](_0x12a9ba+0.3);const _0x5b0007=audioCtx[_0xa95993(0x14d)]();_0x5b0007[_0xa95993(0xa0)]='triangle',_0x5b0007[_0xa95993(0x12b)][_0xa95993(0xea)](783.99,_0x12a9ba+0.2),_0x5b0007[_0xa95993(0xa6)](_0x14b86b),_0x5b0007[_0xa95993(0xe0)](_0x12a9ba+0.2),_0x5b0007[_0xa95993(0xba)](_0x12a9ba+0.3),_0x14b86b[_0xa95993(0x121)][_0xa95993(0x166)](0.0001,_0x12a9ba+0.3);}function playTimeoutSFX(){const _0x2d6827=_0x591043;if(!settings[_0x2d6827(0xb6)]||!audioCtx)return;const _0x56b4d2=audioCtx[_0x2d6827(0xaa)],_0x98cb76=audioCtx[_0x2d6827(0x147)]();_0x98cb76['connect'](audioCtx[_0x2d6827(0xf6)]),_0x98cb76[_0x2d6827(0x121)][_0x2d6827(0xea)](0.4,_0x56b4d2);const _0x3ee0e9=audioCtx['createOscillator']();_0x3ee0e9[_0x2d6827(0xa0)]='sawtooth',_0x3ee0e9[_0x2d6827(0x12b)]['setValueAtTime'](0x6e,_0x56b4d2),_0x3ee0e9[_0x2d6827(0xa6)](_0x98cb76),_0x3ee0e9[_0x2d6827(0xe0)](_0x56b4d2),_0x3ee0e9[_0x2d6827(0xba)](_0x56b4d2+0.5),_0x98cb76['gain']['exponentialRampToValueAtTime'](0.0001,_0x56b4d2+0.5);}function base64ToArrayBuffer(_0x15b608){const _0x2d9268=_0x591043,_0x3140dc=window[_0x2d9268(0xe5)](_0x15b608),_0x30f65a=_0x3140dc['length'],_0x2f136f=new Uint8Array(_0x30f65a);for(let _0x42b6fd=0x0;_0x42b6fd<_0x30f65a;_0x42b6fd++){_0x2f136f[_0x42b6fd]=_0x3140dc[_0x2d9268(0xfd)](_0x42b6fd);}return _0x2f136f[_0x2d9268(0x12e)];}function pcmToWav(_0x450731,_0x311b47){const _0x179788=_0x591043,_0x32a6c9=_0x450731[_0x179788(0x157)],_0x3466aa=0x1,_0x57050e=0x10,_0x5e093e=_0x311b47*_0x3466aa*(_0x57050e/0x8),_0x549098=_0x3466aa*(_0x57050e/0x8),_0x3e4ddf=new ArrayBuffer(0x2c+_0x32a6c9*0x2),_0x281c06=new DataView(_0x3e4ddf);writeString(_0x281c06,0x0,_0x179788(0xda)),_0x281c06[_0x179788(0x11b)](0x4,0x24+_0x32a6c9*0x2,!![]),writeString(_0x281c06,0x8,_0x179788(0x13c)),writeString(_0x281c06,0xc,_0x179788(0xcc)),_0x281c06['setUint32'](0x10,0x10,!![]),_0x281c06[_0x179788(0xe1)](0x14,0x1,!![]),_0x281c06[_0x179788(0xe1)](0x16,_0x3466aa,!![]),_0x281c06['setUint32'](0x18,_0x311b47,!![]),_0x281c06[_0x179788(0x11b)](0x1c,_0x5e093e,!![]),_0x281c06[_0x179788(0xe1)](0x20,_0x549098,!![]),_0x281c06[_0x179788(0xe1)](0x22,_0x57050e,!![]),writeString(_0x281c06,0x24,'data'),_0x281c06['setUint32'](0x28,_0x32a6c9*0x2,!![]);let _0x22da18=0x2c;for(let _0x25fdcd=0x0;_0x25fdcd<_0x450731[_0x179788(0x157)];_0x25fdcd++,_0x22da18+=0x2){_0x281c06[_0x179788(0xfb)](_0x22da18,_0x450731[_0x25fdcd],!![]);}return new Blob([_0x281c06],{'type':_0x179788(0xa7)});}function writeString(_0x285f30,_0x21b67c,_0x3dfc36){const _0x470793=_0x591043;for(let _0x11945b=0x0;_0x11945b<_0x3dfc36[_0x470793(0x157)];_0x11945b++){_0x285f30[_0x470793(0xb0)](_0x21b67c+_0x11945b,_0x3dfc36[_0x470793(0xfd)](_0x11945b));}}function speakBrowserFallback(_0x2ad233){const _0x4be9fa=_0x591043;if(!settings[_0x4be9fa(0x100)]||!window[_0x4be9fa(0x8b)])return;try{const _0x52df8e=new SpeechSynthesisUtterance(_0x2ad233);_0x52df8e[_0x4be9fa(0x8e)]=_0x4be9fa(0xdd),_0x52df8e[_0x4be9fa(0x99)]=0.9,window['speechSynthesis'][_0x4be9fa(0xe6)](),window[_0x4be9fa(0x8b)]['speak'](_0x52df8e);}catch(_0xeedaf){console[_0x4be9fa(0xce)]('Browser\x20Speech\x20Synthesis\x20failed:',_0xeedaf);}}function generateMathProblem(){const _0x2360f3=_0x591043,_0x49b013=Math[_0x2360f3(0x160)](Math[_0x2360f3(0xb5)]()*0xb)+0x2,_0x15be9d=Math[_0x2360f3(0x160)](Math['random']()*0xc)+0x1;return{'text':_0x49b013+_0x2360f3(0xd5)+_0x15be9d+_0x2360f3(0x170),'answer':_0x49b013*_0x15be9d};}async function speak(_0x3e3117){const _0xae0eec=_0x591043;if(!settings['ttsFinal'])return;const _0x3d0572=_0xae0eec(0xeb),_0x282f0d=_0xae0eec(0xef)+_0x3d0572+_0xae0eec(0x150)+GEMINI_API_KEY,_0x35f452={'contents':[{'parts':[{'text':_0x3e3117}]}],'generationConfig':{'responseModalities':[_0xae0eec(0xe3)],'speechConfig':{'voiceConfig':{'prebuiltVoiceConfig':{'voiceName':_0xae0eec(0x161)}}}},'model':_0x3d0572};try{const _0xaa635d=await fetchWithBackoff(_0x282f0d,{'method':_0xae0eec(0xc5),'headers':{'Content-Type':_0xae0eec(0x144)},'body':JSON[_0xae0eec(0x114)](_0x35f452)}),_0x28ec93=_0xaa635d?.[_0xae0eec(0x159)]?.[0x0]?.['content']?.['parts']?.[0x0],_0x21c4e1=_0x28ec93?.[_0xae0eec(0x13e)]?.[_0xae0eec(0x15a)],_0x483847=_0x28ec93?.[_0xae0eec(0x13e)]?.['mimeType'];if(_0x21c4e1&&_0x483847&&_0x483847['startsWith'](_0xae0eec(0x142))){const _0x37e111=_0x483847[_0xae0eec(0x140)](/rate=(\d+)/),_0x40e46e=_0x37e111?parseInt(_0x37e111[0x1],0xa):0x5dc0,_0x24b7be=base64ToArrayBuffer(_0x21c4e1),_0x409f1f=new Int16Array(_0x24b7be),_0x1f08d0=pcmToWav(_0x409f1f,_0x40e46e),_0x56a700=URL[_0xae0eec(0x11e)](_0x1f08d0),_0x4398ed=new Audio(_0x56a700);_0x4398ed[_0xae0eec(0xe9)](),_0x4398ed[_0xae0eec(0xf8)]=()=>{URL['revokeObjectURL'](_0x56a700);};}else throw new Error(_0xae0eec(0xec));}catch(_0x34c4cb){console[_0xae0eec(0xce)](_0xae0eec(0x117),_0x34c4cb),speakBrowserFallback(_0x3e3117);}}async function initFirebase(){const _0x4b2c55=_0x591043;try{const _0x24a8d9=initializeApp(firebaseConfig);db=getFirestore(_0x24a8d9),auth=getAuth(_0x24a8d9),setLogLevel('Debug'),console[_0x4b2c55(0x127)](_0x4b2c55(0x95)),onAuthStateChanged(auth,async _0xf178d9=>{const _0x55359f=_0x4b2c55;_0xf178d9?(console[_0x55359f(0x127)](_0x55359f(0x145),_0xf178d9[_0x55359f(0x169)]),userId=_0xf178d9['uid'],settingsDoc=doc(db,_0x55359f(0xd8)+appId+_0x55359f(0xc0)),listCollectionPath=_0x55359f(0xd8)+appId+_0x55359f(0xfc),listsCollection=collection(db,listCollectionPath),wordListCollectionPath=_0x55359f(0xd8)+appId+_0x55359f(0x152),wordListsCollection=collection(db,wordListCollectionPath),await loadSettingsFromFirebase(),loadFirebaseLists(),loadFirebaseWordLists()):(console[_0x55359f(0x127)](_0x55359f(0x103)),await signInAnonymously(auth));});}catch(_0x3093d6){console['error'](_0x4b2c55(0x109),_0x3093d6),listSelect[_0x4b2c55(0x10d)]=_0x4b2c55(0x167),wordListSelect[_0x4b2c55(0x10d)]=_0x4b2c55(0x167);}}function loadFirebaseLists(){if(!listsCollection)return;onSnapshot(listsCollection,_0x3fd987=>{const _0x466a61=_0x20ce;listSelect[_0x466a61(0x10d)]='';if(_0x3fd987[_0x466a61(0xd7)]){listSelect[_0x466a61(0x10d)]='<option\x20value=\x22\x22>ไม่มีลิสต์ที่บันทึกไว้</option>';return;}const _0x3df26c=[];_0x3fd987[_0x466a61(0x16e)](_0x2126be=>{const _0x1cfb4a=_0x466a61;_0x3df26c[_0x1cfb4a(0x14c)]({'id':_0x2126be['id'],'name':_0x2126be[_0x1cfb4a(0x15a)]()['name']||_0x1cfb4a(0xf9)});}),_0x3df26c[_0x466a61(0xa3)]((_0x51ecff,_0xf84843)=>{const _0x12e882=_0x466a61;return _0x51ecff[_0x12e882(0x13a)][_0x12e882(0x136)](_0xf84843[_0x12e882(0x13a)],'th');}),_0x3df26c[_0x466a61(0x16e)](_0x2a1db3=>{const _0x19d990=_0x466a61,_0x373408=document[_0x19d990(0x88)]('option');_0x373408['value']=_0x2a1db3['id'],_0x373408[_0x19d990(0x8c)]=_0x2a1db3['name'],listSelect[_0x19d990(0x9c)](_0x373408);});},_0x8809d5=>{const _0x476c7c=_0x20ce;console[_0x476c7c(0x15b)](_0x476c7c(0x14f),_0x8809d5),listSelect[_0x476c7c(0x10d)]=_0x476c7c(0xd1);});}async function handleLoadSelectedList(){const _0xa99a76=_0x591043,_0x35e4ec=listSelect[_0xa99a76(0x14b)];if(!_0x35e4ec)return;try{const _0x10ab53=doc(db,listCollectionPath,_0x35e4ec),_0x25b877=await getDoc(_0x10ab53);_0x25b877[_0xa99a76(0x87)]()&&(nameListTextArea['value']=_0x25b877[_0xa99a76(0x15a)]()['names']||'',newListNameInput['value']=_0x25b877[_0xa99a76(0x15a)]()[_0xa99a76(0x13a)]||'',updateMasterNamesFromTextArea());}catch(_0x1c98b0){console[_0xa99a76(0x15b)]('Error\x20loading\x20name\x20doc:',_0x1c98b0);}}async function handleSaveAsNewList(){const _0xb4c36d=_0x591043,_0x52a826=newListNameInput['value']['trim'](),_0x3a14d1=nameListTextArea[_0xb4c36d(0x14b)];if(!_0x52a826){newListNameInput['focus']();return;}try{const _0x590a9b=await addDoc(listsCollection,{'name':_0x52a826,'names':_0x3a14d1,'createdBy':userId});newListNameInput[_0xb4c36d(0x14b)]='',listSelect['value']=_0x590a9b['id'];}catch(_0x24e885){console[_0xb4c36d(0x15b)](_0xb4c36d(0xa5),_0x24e885);}}async function handleUpdateSelectedList(){const _0x164a60=_0x591043,_0xbbb591=listSelect[_0x164a60(0x14b)];if(!_0xbbb591)return;const _0x4bd82e=newListNameInput[_0x164a60(0x14b)][_0x164a60(0x16b)]()||listSelect[_0x164a60(0x122)][listSelect['selectedIndex']][_0x164a60(0x112)],_0xedad1d=nameListTextArea[_0x164a60(0x14b)];try{const _0xbb323f=doc(db,listCollectionPath,_0xbbb591);await updateDoc(_0xbb323f,{'name':_0x4bd82e,'names':_0xedad1d});}catch(_0x1d2bcd){console[_0x164a60(0x15b)](_0x164a60(0xee),_0x1d2bcd);}}async function handleDeleteSelectedList(){const _0x4a3940=_0x591043,_0x200465=listSelect[_0x4a3940(0x14b)];if(!_0x200465)return;const _0x33c515=listSelect['options'][listSelect['selectedIndex']][_0x4a3940(0x112)];if(newListNameInput['value']['trim']()!==_0x33c515){console['warn'](_0x4a3940(0x13f));return;}try{const _0x3d6966=doc(db,listCollectionPath,_0x200465);await deleteDoc(_0x3d6966),nameListTextArea[_0x4a3940(0x14b)]='',newListNameInput['value']='',updateMasterNamesFromTextArea();}catch(_0x4dfd3c){console[_0x4a3940(0x15b)](_0x4a3940(0xf1),_0x4dfd3c);}}function loadFirebaseWordLists(){if(!wordListsCollection)return;onSnapshot(wordListsCollection,_0xd35545=>{const _0x339c41=_0x20ce;wordListSelect[_0x339c41(0x10d)]='';if(_0xd35545[_0x339c41(0xd7)]){wordListSelect[_0x339c41(0x10d)]=_0x339c41(0xb7);return;}const _0x11a9e7=[];_0xd35545['forEach'](_0x9d6c06=>{const _0x5ced2e=_0x339c41;_0x11a9e7[_0x5ced2e(0x14c)]({'id':_0x9d6c06['id'],'name':_0x9d6c06[_0x5ced2e(0x15a)]()[_0x5ced2e(0x13a)]||_0x5ced2e(0xf9)});}),_0x11a9e7[_0x339c41(0xa3)]((_0x721f59,_0x1c205d)=>{const _0x2a71b1=_0x339c41;return _0x721f59[_0x2a71b1(0x13a)][_0x2a71b1(0x136)](_0x1c205d['name'],'th');}),_0x11a9e7['forEach'](_0x38de4d=>{const _0x477b82=_0x339c41,_0x154f15=document[_0x477b82(0x88)](_0x477b82(0x137));_0x154f15[_0x477b82(0x14b)]=_0x38de4d['id'],_0x154f15['textContent']=_0x38de4d[_0x477b82(0x13a)],wordListSelect[_0x477b82(0x9c)](_0x154f15);});},_0x5192dd=>{const _0x1d7b8a=_0x20ce;console[_0x1d7b8a(0x15b)](_0x1d7b8a(0x105),_0x5192dd),wordListSelect[_0x1d7b8a(0x10d)]=_0x1d7b8a(0xd1);});}async function handleLoadSelectedWordList(){const _0x2dbb01=_0x591043,_0x522bd6=wordListSelect[_0x2dbb01(0x14b)];if(!_0x522bd6)return;try{const _0x1c1dfc=doc(db,wordListCollectionPath,_0x522bd6),_0x2f2c4c=await getDoc(_0x1c1dfc);_0x2f2c4c['exists']()&&(wordListTextArea[_0x2dbb01(0x14b)]=_0x2f2c4c[_0x2dbb01(0x15a)]()[_0x2dbb01(0x168)]||'',newWordListNameInput['value']=_0x2f2c4c['data']()[_0x2dbb01(0x13a)]||'',updateMasterWordsFromTextArea());}catch(_0x58551a){console[_0x2dbb01(0x15b)](_0x2dbb01(0xbf),_0x58551a);}}function _0x1da8(){const _0x24d421=['Untitled','new-word-list-name-input','setInt16','/public/data/name-lists','charCodeAt','delete-selected-list-button','Web\x20Audio\x20API\x20is\x20not\x20supported\x20in\x20this\x20browser.','ttsFinal','text-blue-200','mode-toggle-words','User\x20not\x20signed\x20in,\x20signing\x20in\x20anonymously...','mode-direct','Error\x20loading\x20word\x20lists:','direct','เล่นครบทุกคำแล้ว!','shift','Error\x20initializing\x20Firebase:','sfx-toggle','scrollTop','7FBgYhf','innerHTML','names-remaining','manual','Master\x20words\x20updated:','reveal-delay','text','className','stringify','4134918yryIWm','save-as-new-list-button','Gemini\x20TTS\x20API\x20failed,\x20falling\x20back\x20to\x20browser\x20speech:','webkitAudioContext','ai-generate-button','content','setUint32','G-W19QNQQR25','split','createObjectURL','AIzaSyBpbTmQsKO5LzlNphSZW99NYg8H75ryg44','Settings\x20saved\x20to\x20Firebase.','gain','options','Error\x20saving\x20new\x20word\x20list:','1534804EcmnJv','gemini-2.5-flash-preview-09-2025','\x20คำ\x20โดยเริ่มจาก\x20','log','settings-button','math-timer-seconds','max','frequency','text-red-500','Fetch\x20error:','buffer','text-gray-600\x20transition-all\x20duration-100\x20ease-in-out\x20inline-block\x20mx-1','span','add','default-smartroll-app','load-selected-word-list-button','1022312PEhfrS','415403943738','localeCompare','option','API\x20request\x20failed\x20with\x20status\x20','settings-modal','name','start-button','WAVE','mode-manual','inlineData','Delete\x20safety\x20check\x20failed.','match','Invalid\x20AI\x20response\x20structure.','audio/','mode-auto','application/json','User\x20signed\x20in:','revealDelayMs','createGain','ai-loading-spinner','7834650FhBqcI','checked','value','push','createOscillator','parse','Error\x20loading\x20name\x20lists:',':generateContent?key=','API\x20request\x20failed\x20after\x20retries\x20with\x20status\x20','/public/data/smartroll_wordsets','getElementById','enableMathChallenge','programpp-91f08.firebaseapp.com','Error\x20deleting\x20word\x20list:','length','word-list-select','candidates','data','error','text-gray-500','9488SyoosS','sine','countdown-timer','floor','Laomedeia','\x20ตัว)','now','\x20พยางค์\x20(graphemes)\x20คำต่อๆ\x20ไปต้องมีความยาวเท่ากับหรือมากกว่าคำก่อนหน้า\x20รวมทั้งหมด\x20','names-total','exponentialRampToValueAtTime','<option\x20value=\x22\x22>Firebase\x20Error</option>','names','uid','new-list-name-input','trim','reveal-answer-button','mode-toggle-names','forEach','word-list-textarea','\x20=\x20?','exists','createElement','update-selected-word-list-button','words','speechSynthesis','textContent','includes','lang','load-selected-list-button','filter','Error\x20updating\x20word\x20list:','(คำถาม:\x20','click','save-as-new-word-list-button','Firebase\x20initialized.','remove','update-list-button','1:415403943738:web:f56ec72de49f81f0315203','rate','history-area','status','appendChild','Error\x20saving\x20settings\x20to\x20Firebase:','OBJECT','\x20คำ\x20(เริ่ม\x20','type','scrollHeight','no-repeat-toggle','sort','Settings\x20doc\x20not\x20ready,\x20cannot\x20save.','Error\x20saving\x20new\x20name\x20list:','connect','audio/wav','1352gRmNOR','No\x20settings\x20doc\x20found\x20in\x20Firebase,\x20using\x20defaults.','currentTime','\x20คำ','Error\x20calling\x20Gemini\x20API:','programpp-91f08.firebasestorage.app','text-red-400','disabled','setUint8','Master\x20names\x20updated:','2113065LdAJJr','_\x20_\x20_\x20_\x20_','name-list-manager','random','enableSFX','<option\x20value=\x22\x22>ไม่มีชุดคำที่บันทึกไว้</option>','update-word-list-button','classList','stop','map','auto','flash-winner','reset-button','Error\x20loading\x20word\x20doc:','/public/data/smartroll-settings/global-settings','next-button','noRepeat','Resetting\x20session...','math-challenge-text','POST','tts-toggle','AIzaSyBHmJ7M5qf20lKPTB9_aE2Ppa0-jTryuuI','สร้างคำ\x20','triangle','list-select','ARRAY','fmt\x20','parts','warn','undefined','text-green-200','<option\x20value=\x22\x22>Error</option>','Settings\x20doc\x20not\x20ready,\x20cannot\x20load.','join','change','\x20x\x20','303GInZWG','empty','artifacts/','หมดเวลา!\x20(เฉลย:\x20','RIFF','addEventListener','81531YjzgVn','th-TH','text-gray-300','คำที่ทายไปแล้ว\x20(รอบนี้)','start','setUint16','text-4xl\x20md:text-7xl\x20font-bold\x20font-mono\x20tracking-widest\x20text-white\x20select-none','AUDIO','answer','atob','cancel','<p>ยังไม่มีใครถูกเลือก...</p>','segment','play','setValueAtTime','gemini-2.5-flash-preview-tts','Invalid\x20TTS\x20response\x20structure\x20or\x20missing\x20audio\x20data.','selectedIndex','Error\x20updating\x20name\x20list:','https://generativelanguage.googleapis.com/v1beta/models/','ชุดคำ\x20','Error\x20deleting\x20name\x20list:','revealMode','STRING','hidden','ai-start-length','destination','mathChallengeTimer','onended'];_0x1da8=function(){return _0x24d421;};return _0x1da8();}async function handleSaveAsNewWordList(){const _0x519cd0=_0x591043,_0x3dc3c2=newWordListNameInput[_0x519cd0(0x14b)][_0x519cd0(0x16b)](),_0x540017=wordListTextArea[_0x519cd0(0x14b)];if(!_0x3dc3c2){newWordListNameInput['focus']();return;}try{const _0x3c1728=await addDoc(wordListsCollection,{'name':_0x3dc3c2,'names':_0x540017,'createdBy':userId});newWordListNameInput['value']='',wordListSelect['value']=_0x3c1728['id'];}catch(_0x4d280f){console[_0x519cd0(0x15b)](_0x519cd0(0x123),_0x4d280f);}}async function handleUpdateSelectedWordList(){const _0x1276e2=_0x591043,_0x3b1150=wordListSelect[_0x1276e2(0x14b)];if(!_0x3b1150)return;const _0x1634a7=newWordListNameInput[_0x1276e2(0x14b)]['trim']()||wordListSelect[_0x1276e2(0x122)][wordListSelect['selectedIndex']][_0x1276e2(0x112)],_0x446a78=wordListTextArea[_0x1276e2(0x14b)];try{const _0x30c1d7=doc(db,wordListCollectionPath,_0x3b1150);await updateDoc(_0x30c1d7,{'name':_0x1634a7,'names':_0x446a78});}catch(_0x3fc61b){console['error'](_0x1276e2(0x91),_0x3fc61b);}}async function handleDeleteSelectedWordList(){const _0x3b54be=_0x591043,_0x2dc4e7=wordListSelect[_0x3b54be(0x14b)];if(!_0x2dc4e7)return;const _0x57de98=wordListSelect[_0x3b54be(0x122)][wordListSelect[_0x3b54be(0xed)]][_0x3b54be(0x112)];if(newWordListNameInput['value']['trim']()!==_0x57de98){console['warn']('Delete\x20safety\x20check\x20failed.');return;}try{const _0x36e1da=doc(db,wordListCollectionPath,_0x2dc4e7);await deleteDoc(_0x36e1da),wordListTextArea[_0x3b54be(0x14b)]='',newWordListNameInput[_0x3b54be(0x14b)]='',updateMasterWordsFromTextArea();}catch(_0x448d93){console[_0x3b54be(0x15b)](_0x3b54be(0x156),_0x448d93);}}async function fetchWithBackoff(_0x46bdee,_0x48e8,_0x44b4e=0x3,_0x5659b4=0x3e8){const _0x1a1dbd=_0x591043;try{const _0x52b11a=await fetch(_0x46bdee,_0x48e8);if(!_0x52b11a['ok']){if(_0x52b11a[_0x1a1dbd(0x9b)]===0x1ad||_0x52b11a[_0x1a1dbd(0x9b)]>=0x1f4){if(_0x44b4e>0x0)return await new Promise(_0x329bbe=>setTimeout(_0x329bbe,_0x5659b4)),fetchWithBackoff(_0x46bdee,_0x48e8,_0x44b4e-0x1,_0x5659b4*0x2);else throw new Error(_0x1a1dbd(0x151)+_0x52b11a[_0x1a1dbd(0x9b)]);}throw new Error(_0x1a1dbd(0x138)+_0x52b11a[_0x1a1dbd(0x9b)]);}return _0x52b11a['json']();}catch(_0x13552e){console['error'](_0x1a1dbd(0x12d),_0x13552e);throw _0x13552e;}}function _0x20ce(_0x36016e,_0x3ed9f2){const _0x1da89f=_0x1da8();return _0x20ce=function(_0x20cee6,_0x25f887){_0x20cee6=_0x20cee6-0x87;let _0x984dcf=_0x1da89f[_0x20cee6];return _0x984dcf;},_0x20ce(_0x36016e,_0x3ed9f2);}async function handleAIGenerate(){const _0x4c3b5f=_0x591043;showButton(aiLoadingSpinner),hideButton(aiErrorMessage),aiGenerateButton['disabled']=!![];const _0x157766=parseInt(aiWordCount[_0x4c3b5f(0x14b)])||0x5,_0x3c138a=parseInt(aiStartLength[_0x4c3b5f(0x14b)])||0x2,_0x1f30f5='คุณคือผู้เชี่ยวชาญภาษาไทย\x20สร้างรายการคำศัพท์ไทยทั่วไปที่คนรู้จัก\x20คำแรกต้องมี\x20'+_0x3c138a+_0x4c3b5f(0x164)+_0x157766+_0x4c3b5f(0xab),_0x17f35a=_0x4c3b5f(0xc8)+_0x157766+_0x4c3b5f(0x126)+_0x3c138a+'\x20พยางค์\x20และคำต่อๆ\x20ไปให้ยาวขึ้นหรือเท่าเดิม',_0x3a4e51={'contents':[{'parts':[{'text':_0x17f35a}]}],'systemInstruction':{'parts':[{'text':_0x1f30f5}]},'generationConfig':{'responseMimeType':_0x4c3b5f(0x144),'responseSchema':{'type':_0x4c3b5f(0x9e),'properties':{'words':{'type':_0x4c3b5f(0xcb),'items':{'type':_0x4c3b5f(0xf3)}}},'required':['words']}}};try{const _0x25bc4f=await fetchWithBackoff(GEMINI_API_URL,{'method':_0x4c3b5f(0xc5),'headers':{'Content-Type':'application/json'},'body':JSON['stringify'](_0x3a4e51)}),_0x22fbe7=_0x25bc4f[_0x4c3b5f(0x159)]?.[0x0]?.[_0x4c3b5f(0x11a)]?.[_0x4c3b5f(0xcd)]?.[0x0]?.[_0x4c3b5f(0x112)];if(!_0x22fbe7)throw new Error(_0x4c3b5f(0x141));const _0x139f25=JSON[_0x4c3b5f(0x14e)](_0x22fbe7),_0x5e506d=_0x139f25[_0x4c3b5f(0x8a)];if(_0x5e506d&&_0x5e506d['length']>0x0)wordListTextArea[_0x4c3b5f(0x14b)]=_0x5e506d[_0x4c3b5f(0xd3)]('\x0a'),updateMasterWordsFromTextArea(),newWordListNameInput[_0x4c3b5f(0x14b)]=_0x4c3b5f(0xf0)+_0x157766+_0x4c3b5f(0x9f)+_0x3c138a+_0x4c3b5f(0x162);else throw new Error('AI\x20returned\x20no\x20words.');}catch(_0x478f7e){console[_0x4c3b5f(0x15b)](_0x4c3b5f(0xac),_0x478f7e),showButton(aiErrorMessage);}finally{hideButton(aiLoadingSpinner),aiGenerateButton[_0x4c3b5f(0xaf)]=![];}}async function saveSettingsToFirebase(){const _0x5cc90f=_0x591043;if(!settingsDoc){console[_0x5cc90f(0xce)](_0x5cc90f(0xa4));return;}try{await setDoc(settingsDoc,settings),console[_0x5cc90f(0x127)](_0x5cc90f(0x120));}catch(_0xc9ff9a){console[_0x5cc90f(0x15b)](_0x5cc90f(0x9d),_0xc9ff9a);}}async function loadSettingsFromFirebase(){const _0x5576da=_0x591043;if(!settingsDoc){console[_0x5576da(0xce)](_0x5576da(0xd2));return;}try{const _0x32d45f=await getDoc(settingsDoc);if(_0x32d45f[_0x5576da(0x87)]()){const _0x3ac739=_0x32d45f[_0x5576da(0x15a)]();settings['revealDelayMs']=_0x3ac739['revealDelayMs']??settings[_0x5576da(0x146)],settings[_0x5576da(0xb6)]=_0x3ac739[_0x5576da(0xb6)]??settings[_0x5576da(0xb6)],settings[_0x5576da(0x100)]=_0x3ac739[_0x5576da(0x100)]??settings[_0x5576da(0x100)],settings[_0x5576da(0xc2)]=_0x3ac739[_0x5576da(0xc2)]??settings[_0x5576da(0xc2)],settings['revealMode']=_0x3ac739[_0x5576da(0xf2)]??settings[_0x5576da(0xf2)],console[_0x5576da(0x127)]('Settings\x20loaded\x20from\x20Firebase:',settings),settings[_0x5576da(0x154)]=_0x3ac739['enableMathChallenge']??settings[_0x5576da(0x154)],settings['mathChallengeTimer']=_0x3ac739[_0x5576da(0xf7)]??settings[_0x5576da(0xf7)];}else console[_0x5576da(0x127)](_0x5576da(0xa9));}catch(_0x590ee6){console[_0x5576da(0xce)]('Error\x20loading\x20settings\x20from\x20Firebase:',_0x590ee6);}updateSettingsModalUI();}function toggleSettingsModal(){const _0x1a576b=_0x591043;settingsModal[_0x1a576b(0xb9)]['toggle'](_0x1a576b(0xf4)),!settingsModal[_0x1a576b(0xb9)]['contains'](_0x1a576b(0xf4))&&updateSettingsModalUI();}function updateSettingsModalUI(){const _0x58acea=_0x591043;document[_0x58acea(0x153)](_0x58acea(0x111))[_0x58acea(0x14b)]=settings[_0x58acea(0x146)],document[_0x58acea(0x153)]('sfx-toggle')['checked']=settings[_0x58acea(0xb6)],document[_0x58acea(0x153)](_0x58acea(0xc6))['checked']=settings[_0x58acea(0x100)],document['getElementById'](_0x58acea(0xa2))[_0x58acea(0x14a)]=settings[_0x58acea(0xc2)],document['getElementById']('math-challenge-toggle')[_0x58acea(0x14a)]=settings['enableMathChallenge'],document[_0x58acea(0x153)](_0x58acea(0x129))[_0x58acea(0x14b)]=settings[_0x58acea(0xf7)];if(settings[_0x58acea(0xf2)]===_0x58acea(0x10f))document[_0x58acea(0x153)](_0x58acea(0x13d))[_0x58acea(0x14a)]=!![];else settings[_0x58acea(0xf2)]===_0x58acea(0x106)?document[_0x58acea(0x153)](_0x58acea(0x104))[_0x58acea(0x14a)]=!![]:document['getElementById'](_0x58acea(0x143))[_0x58acea(0x14a)]=!![];}async function saveSettings(){const _0x25ee33=_0x591043;settings[_0x25ee33(0x146)]=parseInt(document[_0x25ee33(0x153)]('reveal-delay')[_0x25ee33(0x14b)])||0x12c,settings[_0x25ee33(0xb6)]=document[_0x25ee33(0x153)](_0x25ee33(0x10a))[_0x25ee33(0x14a)],settings['ttsFinal']=document[_0x25ee33(0x153)](_0x25ee33(0xc6))[_0x25ee33(0x14a)],settings['noRepeat']=document[_0x25ee33(0x153)](_0x25ee33(0xa2))['checked'],settings[_0x25ee33(0x154)]=document[_0x25ee33(0x153)]('math-challenge-toggle')[_0x25ee33(0x14a)],settings['mathChallengeTimer']=parseInt(document[_0x25ee33(0x153)](_0x25ee33(0x129))[_0x25ee33(0x14b)])||0x0;if(document[_0x25ee33(0x153)](_0x25ee33(0x13d))[_0x25ee33(0x14a)])settings[_0x25ee33(0xf2)]='manual';else document['getElementById'](_0x25ee33(0x104))[_0x25ee33(0x14a)]?settings['revealMode']=_0x25ee33(0x106):settings[_0x25ee33(0xf2)]=_0x25ee33(0xbc);await saveSettingsToFirebase(),!settings[_0x25ee33(0xc2)]&&resetSession(),toggleSettingsModal();}function toggleAppMode(){const _0x80aa83=_0x591043;modeToggleWords[_0x80aa83(0x14a)]?(appMode='wordgame',hideButton(nameListManager),showButton(wordListManager),historyTitle[_0x80aa83(0x8c)]=_0x80aa83(0xdf),historyTitle[_0x80aa83(0xb9)][_0x80aa83(0x96)](_0x80aa83(0x101)),historyTitle[_0x80aa83(0xb9)][_0x80aa83(0x131)](_0x80aa83(0xd0)),updateMasterWordsFromTextArea()):(appMode='names',showButton(nameListManager),hideButton(wordListManager),historyTitle[_0x80aa83(0x8c)]='ประวัติการเลือก\x20(รอบนี้)',historyTitle[_0x80aa83(0xb9)][_0x80aa83(0x131)](_0x80aa83(0x101)),historyTitle[_0x80aa83(0xb9)][_0x80aa83(0x96)](_0x80aa83(0xd0)),updateMasterNamesFromTextArea());}function initApp(){const _0x25be22=_0x591043;initFirebase(),startButton[_0x25be22(0xdb)](_0x25be22(0x93),()=>{initAudio(),startRevealProcess();}),nextButton[_0x25be22(0xdb)]('click',startRevealProcess),resetButton[_0x25be22(0xdb)]('click',resetSession),settingsButton['addEventListener'](_0x25be22(0x93),toggleSettingsModal),closeSettingsButton[_0x25be22(0xdb)](_0x25be22(0x93),saveSettings),revealAnswerButton[_0x25be22(0xdb)](_0x25be22(0x93),()=>{hideButton(revealAnswerButton),startScrambleEffect();}),modeToggleNames['addEventListener'](_0x25be22(0xd4),toggleAppMode),modeToggleWords['addEventListener'](_0x25be22(0xd4),toggleAppMode),updateListButton[_0x25be22(0xdb)](_0x25be22(0x93),updateMasterNamesFromTextArea),loadSelectedListButton[_0x25be22(0xdb)](_0x25be22(0x93),handleLoadSelectedList),deleteSelectedListButton['addEventListener'](_0x25be22(0x93),handleDeleteSelectedList),saveAsNewListButton[_0x25be22(0xdb)](_0x25be22(0x93),handleSaveAsNewList),updateSelectedListButton[_0x25be22(0xdb)](_0x25be22(0x93),handleUpdateSelectedList),aiGenerateButton[_0x25be22(0xdb)](_0x25be22(0x93),handleAIGenerate),updateWordListButton['addEventListener']('click',updateMasterWordsFromTextArea),loadSelectedWordListButton['addEventListener'](_0x25be22(0x93),handleLoadSelectedWordList),deleteSelectedWordListButton[_0x25be22(0xdb)]('click',handleDeleteSelectedWordList),saveAsNewWordListButton[_0x25be22(0xdb)](_0x25be22(0x93),handleSaveAsNewWordList),updateSelectedWordListButton[_0x25be22(0xdb)](_0x25be22(0x93),handleUpdateSelectedWordList),updateMasterNamesFromTextArea();}document[_0x591043(0xdb)]('DOMContentLoaded',initApp);